"use strict";(self.webpackChunkhab_guide=self.webpackChunkhab_guide||[]).push([[1061],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>b});var a=n(7294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var r=a.createContext({}),u=function(e){var t=a.useContext(r),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(r.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,o=e.originalType,r=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=u(n),h=l,b=p["".concat(r,".").concat(h)]||p[h]||d[h]||o;return n?a.createElement(b,s(s({ref:t},c),{},{components:n})):a.createElement(b,s({ref:t},c))}));function b(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var o=n.length,s=new Array(o);s[0]=h;var i={};for(var r in t)hasOwnProperty.call(t,r)&&(i[r]=t[r]);i.originalType=e,i[p]="string"==typeof e?e:l,s[1]=i;for(var u=2;u<o;u++)s[u]=n[u];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},708:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>u});var a=n(7462),l=(n(7294),n(3905));const o={sidebar_position:11},s="Ansible Vault",i={unversionedId:"l1-hosts/ansible-vault",id:"l1-hosts/ansible-vault",title:"Ansible Vault",description:"An Ansible Vault is a secure way (albeit rudimentary) for us to handle",source:"@site/docs/l1-hosts/ansible-vault.md",sourceDirName:"l1-hosts",slug:"/l1-hosts/ansible-vault",permalink:"/hab-guide/docs/l1-hosts/ansible-vault",draft:!1,editUrl:"https://github.com/GildedPleb/hab-guide/edit/master/website/docs/l1-hosts/ansible-vault.md",tags:[],version:"current",lastUpdatedBy:"GildedPleb",lastUpdatedAt:1672878126,formattedLastUpdatedAt:"Jan 5, 2023",sidebarPosition:11,frontMatter:{sidebar_position:11},sidebar:"tutorialSidebar",previous:{title:"Stand-up Vanilla Recap",permalink:"/hab-guide/docs/l1-hosts/vanilla-recap"},next:{title:"Stand-up Live Hosts",permalink:"/hab-guide/docs/l1-hosts/live-hosts"}},r={},u=[{value:"Word To The Wise",id:"word-to-the-wise",level:2},{value:"Speaking of Security...",id:"speaking-of-security",level:2}],c={toc:u};function p(e){let{components:t,...n}=e;return(0,l.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"ansible-vault"},"Ansible Vault"),(0,l.kt)("p",null,"An Ansible Vault is a secure way (albeit rudimentary) for us to handle\npasswords. We will need it to help secure our cluster, and we already have it\ninstalled as it comes with Ansible, and we have already set it with our script\nat the very beginning of the guide. Later, we will be able to migrate passwords\nto even more secure locations."),(0,l.kt)("p",null,"Run this command:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"touch ~/.HAB/vault-hosts && ansible-vault encrypt ~/.HAB/vault-hosts\n")),(0,l.kt)("p",null,"This will create the vault (an empty file named ",(0,l.kt)("inlineCode",{parentName:"p"},"vault-hosts"),") and encrypt it\nwith the password found at ",(0,l.kt)("inlineCode",{parentName:"p"},"~/HAB/.ansible_vault_access")," (check out\n",(0,l.kt)("inlineCode",{parentName:"p"},"ansible.cfg")," to see the mapping)"),(0,l.kt)("p",null,"You should see this response:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"% touch ~/.HAB/vault-hosts && ansible-vault encrypt ~/.HAB/vault-hosts\nEncryption successful\n")),(0,l.kt)("p",null,"You should also view the file you just encrypted to see what is looks like in\nclear text:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"cat ~/.HAB/vault-hosts\n")),(0,l.kt)("p",null,"Viola! No need to worry about these files hitting the terminal from basic\ncommands, they can not be read!"),(0,l.kt)("p",null,"To view the decrypted file, you can run (though, the file is empty, so you won't\nsee anything, yet):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ansible-vault view ~/.HAB/vault-hosts\n")),(0,l.kt)("p",null,"We will keep secrets in encrypted files like this when possible. To edit, you\nwould simply use"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"ansible-vault edit ~/.HAB/vault-hosts\n")),(0,l.kt)("h2",{id:"word-to-the-wise"},"Word To The Wise"),(0,l.kt)("p",null,"Ansible vault can get really finicky with regard to finding the config files\nneeded to map to your password, so be sure you are executing commands in the top\nlevel ",(0,l.kt)("inlineCode",{parentName:"p"},"hab-plays")," folder at all times."),(0,l.kt)("p",null,"To be clear, we could put all these steps in Ansible, and totally abstract away\nthis layer, but it's instructive to have them outside automation as these files\nwill hold the keys to a lot of the castle we are building, and in the case of\nlock out, it's important to know how to get access to things."),(0,l.kt)("admonition",{type:"caution"},(0,l.kt)("p",{parentName:"admonition"},"You will be unable to build any live hosts without first following the Ansible\nVault steps in this section. Which is by design.")),(0,l.kt)("h2",{id:"speaking-of-security"},"Speaking of Security..."),(0,l.kt)("p",null,"If you don't have any ssh RSA keys, you should\n",(0,l.kt)("a",{parentName:"p",href:"https://www.freecodecamp.org/news/the-ultimate-guide-to-ssh-setting-up-ssh-keys/"},"create some"),"\nbefore moving on."),(0,l.kt)("p",null,"Ready to get some live hosts? Let's do it!"))}p.isMDXComponent=!0}}]);